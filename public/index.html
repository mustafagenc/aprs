<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APRS Position Sender - Web Interface</title>
    
    <!-- Favicon ve Web App Manifest -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="shortcut icon" href="/favicon/favicon.ico">
    
    <!-- PWA Meta Tags -->
    <meta name="msapplication-TileColor" content="#2d1b69">
    <meta name="theme-color" content="#2d1b69">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'pulse-slow': 'pulse 2s infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        glow: {
                            from: { boxShadow: '0 4px 15px rgba(239, 68, 68, 0.3)' },
                            to: { boxShadow: '0 4px 25px rgba(239, 68, 68, 0.6)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Uzay teması arkaplan - Dark Mode */
        .space-bg {
            background: linear-gradient(135deg, #0c0c1e 0%, #1a1a3e 25%, #2d1b69 50%, #5b2c87 75%, #8b5a9f 100%);
            position: relative;
            overflow: hidden;
        }
        
        .space-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #fff, transparent),
                radial-gradient(1px 1px at 200px 50px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 230px 90px, #eee, transparent),
                radial-gradient(2px 2px at 280px 10px, rgba(255,255,255,0.9), transparent),
                radial-gradient(1px 1px at 320px 70px, #fff, transparent),
                radial-gradient(1px 1px at 350px 40px, rgba(255,255,255,0.7), transparent);
            background-repeat: repeat;
            background-size: 400px 200px;
            animation: starfield 20s linear infinite;
            pointer-events: none;
        }
        
        /* Yıldızların yanıp sönmesi */
        .space-bg::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(1px 1px at 50px 100px, #fff, transparent),
                radial-gradient(2px 2px at 150px 20px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 250px 120px, #eee, transparent),
                radial-gradient(1px 1px at 300px 60px, rgba(255,255,255,0.9), transparent);
            background-repeat: repeat;
            background-size: 350px 180px;
            animation: twinkle 3s ease-in-out infinite alternate;
            pointer-events: none;
        }
        
        /* Uydu animasyonu - SVG için optimize edilmiş */
        .satellite {
            position: fixed;
            pointer-events: none;
            z-index: 5;
            width: 40px;
            height: 40px;
            filter: drop-shadow(0 0 8px rgba(255,255,255,0.6));
        }
        
        .satellite svg {
            width: 100%;
            height: 100%;
            fill: #ffffff;
            stroke: #87CEEB;
            stroke-width: 0.5;
        }
        
        .satellite-1 {
            animation: satellite-orbit-1 var(--duration, 10s) linear infinite;
        }
        
        .satellite-2 {
            animation: satellite-orbit-2 var(--duration, 12s) linear infinite;
        }
        
        .satellite-3 {
            animation: satellite-orbit-3 var(--duration, 15s) linear infinite;
        }
        
        .satellite-4 {
            animation: satellite-orbit-4 var(--duration, 8s) linear infinite;
        }

        @keyframes satellite-orbit-1 {
            0% { 
                left: -100px; 
                top: var(--start-y, 20%); 
                transform: rotate(0deg) scale(1);
            }
            50% { 
                transform: rotate(180deg) scale(1.2);
            }
            100% { 
                left: calc(100vw + 100px); 
                top: var(--end-y, 80%); 
                transform: rotate(360deg) scale(1);
            }
        }

        @keyframes satellite-orbit-2 {
            0% { 
                left: -80px; 
                top: var(--start-y, 30%); 
                transform: rotate(0deg) scale(0.8);
            }
            25% { 
                transform: rotate(90deg) scale(1.1);
            }
            75% { 
                transform: rotate(270deg) scale(1.1);
            }
            100% { 
                left: calc(100vw + 80px); 
                top: var(--end-y, 60%); 
                transform: rotate(360deg) scale(0.8);
            }
        }

        @keyframes satellite-orbit-3 {
            0% { 
                left: -120px; 
                top: var(--start-y, 40%); 
                transform: rotate(0deg) scale(1.2);
            }
            33% { 
                transform: rotate(120deg) scale(0.9);
            }
            66% { 
                transform: rotate(240deg) scale(1.3);
            }
            100% { 
                left: calc(100vw + 120px); 
                top: var(--end-y, 70%); 
                transform: rotate(360deg) scale(1.2);
            }
        }

        @keyframes satellite-orbit-4 {
            0% { 
                left: -90px; 
                top: var(--start-y, 10%); 
                transform: rotate(0deg) scale(1) rotateY(0deg);
            }
            50% { 
                transform: rotate(180deg) scale(1.1) rotateY(180deg);
            }
            100% { 
                left: calc(100vw + 90px); 
                top: var(--end-y, 90%); 
                transform: rotate(360deg) scale(1) rotateY(360deg);
            }
        }

        @keyframes starfield {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-400px) translateY(-200px); }
        }
        
        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .log-container {
            background: rgba(10, 10, 10, 0.95);
            scrollbar-width: thin;
            scrollbar-color: #6b7280 #374151;
            overflow-y: auto !important;
            border: 1px solid rgba(55, 65, 81, 0.5);
        }
        
        .log-container::-webkit-scrollbar {
            width: 10px;
            display: block !important;
        }
        
        .log-container::-webkit-scrollbar-track {
            background: rgba(20, 20, 20, 0.8);
            border-radius: 5px;
        }
        
        .log-container::-webkit-scrollbar-thumb {
            background: rgba(75, 85, 99, 0.9);
            border-radius: 5px;
            border: 1px solid rgba(55, 65, 81, 0.5);
        }
        
        .log-container::-webkit-scrollbar-thumb:hover {
            background: rgba(107, 114, 128, 1);
        }
        
        .log-container::-webkit-scrollbar-corner {
            background: rgba(20, 20, 20, 0.8);
        }

        /* Ana sayfa scrollbar'ı - Dark Mode */
        ::-webkit-scrollbar {
            width: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(20, 20, 20, 0.8);
            border-radius: 6px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(75, 85, 99, 1);
            border-radius: 6px;
            border: 2px solid rgba(20, 20, 20, 0.8);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(107, 114, 128, 1);
        }
        
        /* Firefox için */
        * {
            scrollbar-width: thin;
            scrollbar-color: rgba(75, 85, 99, 1) rgba(20, 20, 20, 0.8);
        }
        
        /* Body'de scroll zorla */
        body {
            overflow-y: auto !important;
        }
        
        html {
            overflow-y: auto !important;
        }

        .demo-glow {
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3); }
            to { box-shadow: 0 4px 25px rgba(239, 68, 68, 0.6); }
        }

    </style>
</head>
<body class="min-h-screen space-bg p-4 font-sans">


    <div class="max-w-7xl mx-auto p-4">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 drop-shadow-lg">
                📡 APRS Position Sender
            </h1>
            <p class="text-white/90 text-lg drop-shadow">Web arayüzü ile APRS paketlerinizi kontrol edin</p>
        </div>

        <!-- Status Bar -->
        <div class="bg-gray-900/60 backdrop-blur-sm border border-gray-600/40 rounded-lg p-4 mb-6">
            <div class="flex justify-between items-center">
                <div class="flex gap-6">
                    <div class="flex items-center gap-2">
                        <div id="autoIndicator" class="w-2.5 h-2.5 rounded-full bg-red-500 transition-all duration-300"></div>
                        <span class="font-medium text-gray-200 text-sm">Otomatik Gönderim</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div id="sendIndicator" class="w-2.5 h-2.5 rounded-full bg-red-500 transition-all duration-300"></div>
                        <span class="font-medium text-gray-200 text-sm">Tek Gönderim</span>
                    </div>
                </div>
                <div id="timestamp" class="text-xs text-gray-400 font-mono"></div>
            </div>
        </div>

        <!-- Configuration Grid -->
        <div id="configGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
            <!-- Konfigürasyon kartları JavaScript ile doldurulacak -->
        </div>

        <!-- Controls -->
        <div class="mb-6">
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3">
                <button id="startAutoBtn" class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-medium px-4 py-3 rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none flex items-center justify-center gap-2 group">
                    <span class="text-xl group-hover:animate-pulse">🚀</span>
                    <span class="text-sm sm:text-base">Otomatik Başlat</span>
                </button>
                
                <button id="sendOnceBtn" class="bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white font-medium px-4 py-3 rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none flex items-center justify-center gap-2 group">
                    <span class="text-xl group-hover:animate-pulse">📡</span>
                    <span class="text-sm sm:text-base">Tek Gönderim</span>
                </button>
                
                <button id="stopAutoBtn" class="bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-medium px-4 py-3 rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none flex items-center justify-center gap-2 group" disabled>
                    <span class="text-xl group-hover:animate-pulse">🛑</span>
                    <span class="text-sm sm:text-base">Durdur</span>
                </button>
                
                <button id="clearLogsBtn" class="bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white font-medium px-4 py-3 rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow flex items-center justify-center gap-2 group">
                    <span class="text-xl group-hover:animate-pulse">🗑️</span>
                    <span class="text-sm sm:text-base">Logları Temizle</span>
                </button>
            </div>
        </div>

        <!-- Log Section -->
        <div class="bg-gray-900/40 backdrop-blur-sm border border-gray-700/50 rounded-lg shadow-2xl overflow-hidden">
            <div class="bg-gray-800/60 backdrop-blur-sm p-4 border-b border-gray-600/40">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-bold text-gray-100">📋 Canlı Log Görüntüleyici</h3>
                    <span class="text-xs text-gray-400">Real-time APRS işlem logları</span>
                </div>
            </div>
            <div id="logContainer" class="log-container text-green-400 font-mono text-sm p-4 h-80 border border-gray-700/30 rounded">
                <div class="text-blue-400">🚀 APRS Web Arayüzü hazır - bağlantı bekleniyor...</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 pt-6 border-t border-gray-600/40">
            <p class="text-gray-200">
                🎯 APRS Position Sender by 
                <a href="https://mustafagenc.info" class="text-blue-400 hover:text-blue-300 font-semibold" target="_blank">
                    <span id="footerCallsign">TB2ABI</span>
                </a>
            </p>
            <p class="text-sm text-gray-400 mt-2">
                Bu araç amatör telsiz operatörleri için geliştirilmiştir
            </p>
            
            <!-- GitHub Repository Link -->
            <div class="mt-4 mb-2">
                <a href="https://github.com/mustafagenc/aprs" target="_blank" 
                   class="inline-flex items-center gap-2 bg-gray-800/60 hover:bg-gray-700/70 text-gray-200 hover:text-white border border-gray-600/40 hover:border-gray-500/60 px-4 py-2 rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg shadow group">
                    <svg class="w-4 h-4 group-hover:rotate-12 transition-transform duration-300" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    <span class="text-sm font-medium">GitHub Repository</span>
                    <svg class="w-3 h-3 opacity-60" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </a>
            </div>
            
            <p class="text-xs text-gray-500 mt-2 font-mono">
                <span id="appName">APRS-FI</span> v<span id="appVersion">1.0.0</span>
            </p>
        </div>
        
    </div>

    <script>
        // Socket.IO bağlantısı
        const socket = io();
        
        // DOM elementleri
        const startAutoBtn = document.getElementById('startAutoBtn');
        const sendOnceBtn = document.getElementById('sendOnceBtn');
        const stopAutoBtn = document.getElementById('stopAutoBtn');
        const clearLogsBtn = document.getElementById('clearLogsBtn');
        const logContainer = document.getElementById('logContainer');
        const configGrid = document.getElementById('configGrid');
        const timestamp = document.getElementById('timestamp');
        const footerCallsign = document.getElementById('footerCallsign');
        const autoIndicator = document.getElementById('autoIndicator');
        const sendIndicator = document.getElementById('sendIndicator');
        const appName = document.getElementById('appName');
        const appVersion = document.getElementById('appVersion');

        let config = {};

        // Zaman damgası güncelle
        function updateTimestamp() {
            timestamp.textContent = new Date().toLocaleString('tr-TR');
        }
        setInterval(updateTimestamp, 1000);
        updateTimestamp();

        // SVG Uydu oluştur
        function createSatellite() {
            // 6 farklı SVG uydu dosyası
            const satellites = [
                { svg: '/satellites/satellite1.svg', class: 'satellite-1', name: 'Communications Satellite' },
                { svg: '/satellites/satellite2.svg', class: 'satellite-2', name: 'GPS Satellite' },
                { svg: '/satellites/satellite3.svg', class: 'satellite-3', name: 'Weather Satellite' },
                { svg: '/satellites/satellite4.svg', class: 'satellite-4', name: 'Research Satellite' },
                { svg: '/satellites/satellite5.svg', class: 'satellite-1', name: 'Space Station Module' },
                { svg: '/satellites/satellite6.svg', class: 'satellite-2', name: 'Deep Space Probe' }
            ];
            
            const satellite = document.createElement('div');
            const randomSat = satellites[Math.floor(Math.random() * satellites.length)];
            
            satellite.className = `satellite ${randomSat.class}`;
            satellite.title = randomSat.name;
            
            // SVG'yi yükle ve ekle
            fetch(randomSat.svg)
                .then(response => response.text())
                .then(svgContent => {
                    satellite.innerHTML = svgContent;
                })
                .catch(error => {
                    console.warn('SVG yüklenemedi:', error);
                    // Fallback olarak emoji kullan
                    satellite.innerHTML = '🛰️';
                    satellite.style.fontSize = '24px';
                });
            
            // Rastgele yörünge parametreleri
            const startY = Math.random() * 60 + 10; // 10% - 70% arası
            const endY = Math.random() * 60 + 20;   // 20% - 80% arası
            const duration = 8 + Math.random() * 12; // 8-20 saniye arası
            
            satellite.style.setProperty('--start-y', startY + '%');
            satellite.style.setProperty('--end-y', endY + '%');
            satellite.style.setProperty('--duration', duration + 's');
            
            document.body.appendChild(satellite);
            
            // Animasyon bitince elementi kaldır
            setTimeout(() => {
                if (satellite.parentNode) {
                    satellite.parentNode.removeChild(satellite);
                }
            }, duration * 1000);
        }

        // Rastgele aralıklarla uydu oluştur
        function startSatellites() {
            createSatellite();
            // Bir sonraki uydu için 3-8 saniye bekle
            setTimeout(startSatellites, 3000 + Math.random() * 5000);
        }

        // Uzay efektlerini başlat
        setTimeout(startSatellites, 2000);

        // Konfigürasyon kartlarını oluştur
        function createConfigCards(config) {
            const cards = [
                { label: '📡 Çağrı İşareti', value: config.callsign },
                { label: '🌍 Enlem', value: config.latitude + '°' },
                { label: '🌍 Boylam', value: config.longitude + '°' },
                { label: '💬 Yorum', value: config.comment },
                { label: '🔣 Sembol', value: config.symbol },
                { label: '⏰ Aralık', value: config.interval + ' sn' },
                { label: '🔢 Maksimum', value: config.count + ' paket' },
                { label: '✅ Otomatik', value: config.autoEnabled ? 'Aktif' : 'Devre Dışı' }
            ];

            configGrid.innerHTML = cards.map(card => `
                <div class="bg-gray-800/30 backdrop-blur-sm border border-gray-600/40 rounded-lg p-3 transform transition-all duration-300 hover:scale-105 hover:bg-gray-700/40">
                    <div class="flex justify-between items-center">
                        <div class="text-xs font-medium text-gray-300">${card.label}</div>
                        <div class="text-sm font-bold text-gray-100 font-mono bg-gray-700/40 rounded px-2 py-1 truncate max-w-24" title="${card.value}">
                            ${card.value}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Log ekle
        function addLog(type, message) {
            const logEntry = document.createElement('div');
            const timestamp = new Date().toLocaleTimeString('tr-TR');
            
            let colorClass = 'text-green-400';
            if (type === 'warning') colorClass = 'text-yellow-400';
            if (type === 'error') colorClass = 'text-red-400';
            
            logEntry.className = `mb-2 ${colorClass}`;
            logEntry.innerHTML = `<span class="text-gray-500">[${timestamp}]</span> ${message}`;
            
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // Scrollbar'ı zorla göster
            logContainer.style.overflowY = 'scroll';
        }

        // Durum güncelle
        function updateStatus(status) {
            // Indicator animasyonları
            if (status.auto) {
                autoIndicator.className = 'w-3 h-3 rounded-full bg-green-500 animate-pulse-slow transition-all duration-300';
            } else {
                autoIndicator.className = 'w-3 h-3 rounded-full bg-red-500 transition-all duration-300';
            }
            
            if (status.send) {
                sendIndicator.className = 'w-3 h-3 rounded-full bg-green-500 animate-pulse-slow transition-all duration-300';
            } else {
                sendIndicator.className = 'w-3 h-3 rounded-full bg-red-500 transition-all duration-300';
            }
            
            // Demo mode'da butonları her zaman devre dışı bırak
            if (config && config.demoMode) {
                startAutoBtn.disabled = true;
                sendOnceBtn.disabled = true;
                stopAutoBtn.disabled = true;
            } else {
                startAutoBtn.disabled = status.auto;
                stopAutoBtn.disabled = !status.auto;
                sendOnceBtn.disabled = status.send;
            }
        }

        // Socket olayları
        socket.on('config', (data) => {
            config = data;
            createConfigCards(config);
            addLog('info', `📋 Konfigürasyon yüklendi: ${data.callsign}`);
            
            // Footer bilgilerini güncelle
            footerCallsign.textContent = data.callsign;
            if (data.appName) appName.textContent = data.appName;
            if (data.version) appVersion.textContent = data.version;
            
            // Demo mode kontrolü
            if (data.demoMode) {
                // Butonları devre dışı bırak
                startAutoBtn.disabled = true;
                sendOnceBtn.disabled = true;
                
                addLog('warning', `🚫 Demo Mode: ${data.demoMessage}`);
            }
        });

        socket.on('log', (data) => {
            addLog(data.type, data.message);
        });

        socket.on('status', (data) => {
            updateStatus(data);
        });

        socket.on('clear-logs', () => {
            logContainer.innerHTML = '<div class="text-blue-400">🗑️ Log\'lar temizlendi</div>';
        });

        // Buton olayları
        startAutoBtn.addEventListener('click', () => {
            socket.emit('start-auto');
            addLog('info', '🚀 Otomatik gönderim talebi gönderildi...');
        });

        sendOnceBtn.addEventListener('click', () => {
            socket.emit('send-once');
            addLog('info', '📡 Tek gönderim talebi gönderildi...');
        });

        stopAutoBtn.addEventListener('click', () => {
            socket.emit('stop-auto');
            addLog('info', '🛑 Durdurma talebi gönderildi...');
        });

        clearLogsBtn.addEventListener('click', () => {
            socket.emit('clear-logs');
        });

        // Bağlantı durumları
        socket.on('connect', () => {
            addLog('info', '🔗 Web arayüzü bağlandı');
        });

        socket.on('disconnect', () => {
            addLog('error', '❌ Web arayüzü bağlantısı kesildi');
        });
    </script>
</body>
</html>
